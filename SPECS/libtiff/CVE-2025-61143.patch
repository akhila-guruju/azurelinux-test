From f42a3998f5dba33e187097367079f8ec920a20d5 Mon Sep 17 00:00:00 2001
From: Lee Howard <faxguy@howardsilvan.com>
Date: Fri, 5 Sep 2025 11:48:00 -0700
Subject: [PATCH 1/2] avoid out-of-bounds read identified in #733

---
 archive/tools/tiffdither.c | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/archive/tools/tiffdither.c b/archive/tools/tiffdither.c
index 0c86e7f..17673e7 100644
--- a/archive/tools/tiffdither.c
+++ b/archive/tools/tiffdither.c
@@ -87,6 +87,11 @@ static int fsdither(TIFF *in, TIFF *out)
         fprintf(stderr, "Out of memory.\n");
         goto skip_on_error;
     }
+    if (imagewidth > TIFFScanlineSize(in))
+    {
+        fprintf(stderr, "Image width exceeds scanline size.\n");
+        goto skip_on_error;
+    }
 
     /*
      * Get first line
-- 
2.45.4


From c88c56e1ad690bd55a3a2a18a9c68ab49059b11a Mon Sep 17 00:00:00 2001
From: Lee Howard <faxguy@howardsilvan.com>
Date: Fri, 5 Sep 2025 12:11:13 -0700
Subject: [PATCH 2/2] avoid null pointer dereference in tiffcrop #734

Signed-off-by: Azure Linux Security Servicing Account <azurelinux-security@microsoft.com>
Upstream-reference: https://gitlab.com/libtiff/libtiff/-/merge_requests/755.patch
---
 archive/tools/tiffcrop.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/archive/tools/tiffcrop.c b/archive/tools/tiffcrop.c
index adfd0d2..f69efa8 100644
--- a/archive/tools/tiffcrop.c
+++ b/archive/tools/tiffcrop.c
@@ -2925,7 +2925,7 @@ int main(int argc, char *argv[])
         if (dump.outfile != NULL)
         {
             dump_info(dump.outfile, dump.format, "", "Completed run for %s",
-                      TIFFFileName(out));
+                      out ? TIFFFileName(out) : "(not opened)");
             fclose(dump.outfile);
         }
     }
-- 
2.45.4

